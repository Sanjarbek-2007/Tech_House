<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/lucide@latest"></script>
  <title>Details</title>
  <link rel="stylesheet" href="../styles/global.css">
  <link rel="stylesheet" href="../styles/appliance_details.css">
  <link rel="stylesheet" href="../styles/toast.css">
  <link rel="icon" href="../photos/icons/logo_w.svg">
</head>

<body>

  <!-- OVERLAYS -->
  <div class="sidebar-overlay" id="overlay" onclick="toggleMenu()"></div>

  <!-- MOBILE SIDEBAR MENU -->
  <div class="mobile-sidebar" id="mobileSidebar">
    <div class="sidebar-mobile-header">
      <span>Product Categories</span>
      <i data-lucide="x" onclick="toggleMenu()"></i>
    </div>

    <div class="cat-group" onclick="this.classList.toggle('open')">
      <div class="cat-header"><i data-lucide="utensils"></i> <a
          href="appliances_page.html?category=Kitchen Appliances">Kitchen Appliances</a></div>
      <ul class="cat-list">
        <li><a href="appliances_page.html?search=Stand Mixers">Stand Mixers</a></li>
        <li><a href="appliances_page.html?search=Microwave">Microwave Ovens</a></li>
        <li><a href="appliances_page.html?search=Convection">Convection Ovens</a></li>
        <li><a href="appliances_page.html?search=Blender">Power Blenders</a></li>
        <li><a href="appliances_page.html?search=Air Fryer">Air Fryers</a></li>
        <li><a href="appliances_page.html?search=Food Processor">Food Processors</a></li>
        <li><a href="appliances_page.html?search=Coffee">Coffee Makers</a></li>
        <li><a href="appliances_page.html?search=Toaster">Toasters & Grills</a></li>
      </ul>
    </div>

    <div class="cat-group" onclick="this.classList.toggle('open')">
      <div class="cat-header"><i data-lucide="wind"></i> <a
          href="appliances_page.html?category=Cleaning Appliances">Cleaning Appliances</a></div>
      <ul class="cat-list">
        <li><a href="appliances_page.html?search=Robot Vacuum">Robot Vacuums</a></li>
        <li><a href="appliances_page.html?search=Steam Cleaner">Steam Cleaners</a></li>
        <li><a href="appliances_page.html?search=Wet Vacuum">Wet/Dry Vacuums</a></li>
        <li><a href="appliances_page.html?search=Air Purifier">Air Purifiers</a></li>
        <li><a href="appliances_page.html?search=Pressure Washer">Pressure Washers</a></li>
        <li><a href="appliances_page.html?search=Handheld Vacuum">Handheld Vacuums</a></li>
        <li><a href="appliances_page.html?search=Carpet Cleaner">Carpet Cleaners</a></li>
        <li><a href="appliances_page.html?search=Window Cleaner">Window Cleaners</a></li>
      </ul>
    </div>

    <div class="cat-group" onclick="this.classList.toggle('open')">
      <div class="cat-header"><i data-lucide="thermometer"></i> <a
          href="appliances_page.html?category=Heating Appliances">Heating & Cooling</a></div>
      <ul class="cat-list">
        <li><a href="appliances_page.html?search=Heater">Space Heaters</a></li>
        <li><a href="appliances_page.html?search=Fan">Ceiling Fans</a></li>
        <li><a href="appliances_page.html?search=Air Conditioner">Air Conditioners</a></li>
        <li><a href="appliances_page.html?search=Dehumidifier">Dehumidifiers</a></li>
        <li><a href="appliances_page.html?search=Cooler">Evaporative Coolers</a></li>
        <li><a href="appliances_page.html?search=Heating Pad">Heating Pads</a></li>
        <li><a href="appliances_page.html?search=Electric Blanket">Electric Blankets</a></li>
        <li><a href="appliances_page.html?search=Portable AC">Portable AC Units</a></li>
      </ul>
    </div>

    <div class="cat-group" onclick="this.classList.toggle('open')">
      <div class="cat-header"><i data-lucide="scissors"></i> <a
          href="appliances_page.html?category=Personal Care">Personal Care</a></div>
      <ul class="cat-list">
        <li><a href="appliances_page.html?search=Hair Dryer">Hair Dryers</a></li>
        <li><a href="appliances_page.html?search=Straightener">Hair Straighteners</a></li>
        <li><a href="appliances_page.html?search=Shaver">Electric Shavers</a></li>
        <li><a href="appliances_page.html?search=Trimmer">Beard Trimmers</a></li>
        <li><a href="appliances_page.html?search=Massage">Massage Guns</a></li>
        <li><a href="appliances_page.html?search=Toothbrush">Toothbrushes</a></li>
        <li><a href="appliances_page.html?search=Epilator">Epilators</a></li>
        <li><a href="appliances_page.html?search=Skin Care">Skin Care Devices</a></li>
      </ul>
    </div>

    <div class="cat-group" onclick="this.classList.toggle('open')">
      <div class="cat-header"><i data-lucide="home"></i> <a href="appliances_page.html?category=Smart Home">Smart
          Home</a></div>
      <ul class="cat-list">
        <li><a href="appliances_page.html?search=Smart Light">Smart Lights</a></li>
        <li><a href="appliances_page.html?search=Smart Plug">Smart Plugs</a></li>
        <li><a href="appliances_page.html?search=Camera">Security Cameras</a></li>
        <li><a href="appliances_page.html?search=Thermostat">Smart Thermostats</a></li>
        <li><a href="appliances_page.html?search=Voice Assistant">Voice Assistants</a></li>
        <li><a href="appliances_page.html?search=Lock">Smart Locks</a></li>
        <li><a href="appliances_page.html?search=Robot Mop">Robot Mops</a></li>
        <li><a href="appliances_page.html?search=Sensor">Smart Sensors</a></li>
      </ul>
    </div>

    <div class="cat-group" onclick="this.classList.toggle('open')">
      <div class="cat-header"><i data-lucide="zap"></i> <a href="appliances_page.html?category=Other Appliances">Other
          Appliances</a></div>
      <ul class="cat-list">
        <li><a href="appliances_page.html?search=Water Purifier">Water Purifiers</a></li>
        <li><a href="appliances_page.html?search=Iron">Irons & Steamers</a></li>
        <li><a href="appliances_page.html?search=Sewing">Sewing Machines</a></li>
        <li><a href="appliances_page.html?search=Kettle">Electric Kettles</a></li>
        <li><a href="appliances_page.html?search=Rice Cooker">Rice Cookers</a></li>
        <li><a href="appliances_page.html?search=Grill">Indoor Grills</a></li>
        <li><a href="appliances_page.html?search=Waffle">Waffle Makers</a></li>
        <li><a href="appliances_page.html?search=Steamer">Food Steamers</a></li>
      </ul>
    </div>
  </div>

  <!-- DESKTOP HEADER -->
  <header class="main-header" id="mainHeader">
    <nav class="navbar-container">
      <a href="../../index.html" class="logo">
        <img src="../../src/photos/logo_black.png" alt="Logo" class="logo-dark">
        <img src="../../src/photos/logo_w.png" alt="Logo" class="logo-light">
      </a>

      <div class="desktop-catalog">
        <button class="btn-catalog">
          <i data-lucide="layout-grid"></i> Catalog
        </button>
        <div class="mega-menu-desktop">
          <div class="menu-col">
            <h4><i data-lucide="utensils"></i> <a href="appliances_page.html?category=Kitchen Appliances">Kitchen
                Appliances</a></h4>
            <ul>
              <li><a href="appliances_page.html?search=Stand Mixers">Stand Mixers</a></li>
              <li><a href="appliances_page.html?search=Microwave">Microwave Ovens</a></li>
              <li><a href="appliances_page.html?search=Convection">Convection Ovens</a></li>
              <li><a href="appliances_page.html?search=Blender">Power Blenders</a></li>
              <li><a href="appliances_page.html?search=Air Fryer">Air Fryers</a></li>
              <li><a href="appliances_page.html?search=Food Processor">Food Processors</a></li>
              <li><a href="appliances_page.html?search=Coffee">Coffee Makers</a></li>
              <li><a href="appliances_page.html?search=Toaster">Toasters & Grills</a></li>
            </ul>
          </div>
          <div class="menu-col">
            <h4><i data-lucide="wind"></i> <a href="appliances_page.html?category=Cleaning Appliances">Cleaning
                Appliances</a></h4>
            <ul>
              <li><a href="appliances_page.html?search=Robot Vacuum">Robot Vacuums</a></li>
              <li><a href="appliances_page.html?search=Steam Cleaner">Steam Cleaners</a></li>
              <li><a href="appliances_page.html?search=Wet Vacuum">Wet/Dry Vacuums</a></li>
              <li><a href="appliances_page.html?search=Air Purifier">Air Purifiers</a></li>
              <li><a href="appliances_page.html?search=Pressure Washer">Pressure Washers</a></li>
              <li><a href="appliances_page.html?search=Handheld Vacuum">Handheld Vacuums</a></li>
              <li><a href="appliances_page.html?search=Carpet Cleaner">Carpet Cleaners</a></li>
              <li><a href="appliances_page.html?search=Window Cleaner">Window Cleaners</a></li>
            </ul>
          </div>
          <div class="menu-col">
            <h4><i data-lucide="thermometer"></i> <a href="appliances_page.html?category=Heating Appliances">Heating &
                Cooling</a></h4>
            <ul>
              <li><a href="appliances_page.html?search=Heater">Space Heaters</a></li>
              <li><a href="appliances_page.html?search=Fan">Ceiling Fans</a></li>
              <li><a href="appliances_page.html?search=Air Conditioner">Air Conditioners</a></li>
              <li><a href="appliances_page.html?search=Dehumidifier">Dehumidifiers</a></li>
              <li><a href="appliances_page.html?search=Cooler">Evaporative Coolers</a></li>
              <li><a href="appliances_page.html?search=Heating Pad">Heating Pads</a></li>
              <li><a href="appliances_page.html?search=Electric Blanket">Electric Blankets</a></li>
              <li><a href="appliances_page.html?search=Portable AC">Portable AC Units</a></li>
            </ul>
          </div>
          <div class="menu-col">
            <h4><i data-lucide="scissors"></i> <a href="appliances_page.html?category=Personal Care">Personal Care</a>
            </h4>
            <ul>
              <li><a href="appliances_page.html?search=Hair Dryer">Hair Dryers</a></li>
              <li><a href="appliances_page.html?search=Straightener">Hair Straighteners</a></li>
              <li><a href="appliances_page.html?search=Shaver">Electric Shavers</a></li>
              <li><a href="appliances_page.html?search=Trimmer">Beard Trimmers</a></li>
              <li><a href="appliances_page.html?search=Massage">Massage Guns</a></li>
              <li><a href="appliances_page.html?search=Toothbrush">Toothbrushes</a></li>
              <li><a href="appliances_page.html?search=Epilator">Epilators</a></li>
              <li><a href="appliances_page.html?search=Skin Care">Skin Care Devices</a></li>
            </ul>
          </div>
          <div class="menu-col">
            <h4><i data-lucide="home"></i> <a href="appliances_page.html?category=Smart Home">Smart Home</a>
            </h4>
            <ul>
              <li><a href="appliances_page.html?search=Smart Light">Smart Lights</a></li>
              <li><a href="appliances_page.html?search=Smart Plug">Smart Plugs</a></li>
              <li><a href="appliances_page.html?search=Camera">Security Cameras</a></li>
              <li><a href="appliances_page.html?search=Thermostat">Smart Thermostats</a></li>
              <li><a href="appliances_page.html?search=Voice Assistant">Voice Assistants</a></li>
              <li><a href="appliances_page.html?search=Lock">Smart Locks</a></li>
              <li><a href="appliances_page.html?search=Robot Mop">Robot Mops</a></li>
              <li><a href="appliances_page.html?search=Sensor">Smart Sensors</a></li>
            </ul>
          </div>
          <div class="menu-col">
            <h4><i data-lucide="zap"></i> <a href="appliances_page.html?category=Other Appliances">Other
                Appliances</a>
            </h4>
            <ul>
              <li><a href="appliances_page.html?search=Water Purifier">Water Purifiers</a></li>
              <li><a href="appliances_page.html?search=Iron">Irons & Steamers</a></li>
              <li><a href="appliances_page.html?search=Sewing">Sewing Machines</a></li>
              <li><a href="appliances_page.html?search=Kettle">Electric Kettles</a></li>
              <li><a href="appliances_page.html?search=Rice Cooker">Rice Cookers</a></li>
              <li><a href="appliances_page.html?search=Grill">Indoor Grills</a></li>
              <li><a href="appliances_page.html?search=Waffle">Waffle Makers</a></li>
              <li><a href="appliances_page.html?search=Steamer">Food Steamers</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="search-area">
        <form class="search-form" id="searchForm">
          <input aria-label="Search products" type="text" id="searchInput" placeholder="I'm shopping for..."
            autocomplete="off">
          <button type="submit" class="search-btn"><i data-lucide="search"></i></button>
        </form>
        <div class="search-results-dropdown">
          <!-- Search results will be dynamically loaded here -->
        </div>
      </div>

      <div class="user-nav">
        <!-- User Account -->
        <!-- User Account -->
        <a href="auth_page.html" class="nav-link" id="nav-auth-link">
          <i data-lucide="user"></i> <span>Account</span>
        </a>

        <a href="wishlist_page.html" class="nav-link">
          <i data-lucide="heart"></i> <span>Wishlist</span>
        </a>

        <!-- Cart -->
        <a href="cart_page.html" class="nav-link" style="position: relative;">
          <i data-lucide="shopping-cart"></i>
          Cart
          <span class="cart-badge" id="cart-count"
            style="display: none; background: red; color: white; font-size: 10px; border-radius: 50%; padding: 2px 6px;">0</span>
        </a>
      </div>
    </nav>
  </header>

  <!-- CONTENT -->
  <main class="product-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
      <a href="../../index.html">Home</a>
      <i data-lucide="chevron-right"></i>
      <a href="appliances_page.html">Appliances</a>
      <i data-lucide="chevron-right"></i>
      <span>Product Details</span>
    </div>

    <!-- Product Section -->
    <section class="product-section">
      <!-- Left: Gallery -->
      <div class="product-gallery">
        <div class="main-image">
          <img src="" alt="Product Image" id="main-product-image">
          <!-- Placeholder logic handled by JS -->
        </div>
        <div class="thumbnail-gallery">
          <!-- Thumbnails injected by JS -->
        </div>
      </div>

      <!-- Right: Info -->
      <div class="product-info">
        <h1 class="product-title" id="product-title">Loading Product...</h1>

        <div class="product-meta">
          <span id="product-sku">SKU: ---</span>
          <div class="rating-box">
            <i data-lucide="star" fill="#856404" size="16"></i>
            <span>4.8 (120+ Reviews)</span>
          </div>
        </div>

        <div class="price-section">
          <div class="current-price" id="product-price">...</div>
        </div>

        <div class="product-description" id="product-description">
          Loading description...
        </div>

        <!-- Features Grid -->
        <div class="features-grid">
          <div class="feature-item">
            <div class="feature-icon"><i data-lucide="zap" size="16"></i></div>
            <span>Energy Efficient</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon"><i data-lucide="shield-check" size="16"></i></div>
            <span>2 Year Warranty</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon"><i data-lucide="truck" size="16"></i></div>
            <span>Free Shipping</span>
          </div>
          <div class="feature-item">
            <div class="feature-icon"><i data-lucide="rotate-ccw" size="16"></i></div>
            <span>30 Day Returns</span>
          </div>
        </div>

        <!-- Action Section -->
        <div class="action-section">
          <!-- Manual Selector (Hidden initially, shown when item in cart) -->
          <div class="quantity-selector" style="display: none;">
            <button class="qty-btn-manual" id="decreaseQty"><i data-lucide="minus" size="16"></i></button>
            <input type="number" id="quantity" value="1" class="qty-input" min="1" max="10" readonly>
            <button class="qty-btn-manual" id="increaseQty"><i data-lucide="plus" size="16"></i></button>
          </div>

          <!-- Add To Cart (Hidden when item in cart) -->
          <button class="add-to-cart-btn">
            <i data-lucide="shopping-cart"></i> Add to Cart
          </button>

          <!-- Smart Controls (Injected here by JS when item in cart) -->
          <!-- Wrapper ID handled by JS: smart-controls-wrapper -->

          <!-- Wishlist -->
          <button class="wishlist-btn">
            <i data-lucide="heart"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- Product Details Tabs -->
    <section class="product-tabs-section">
      <div class="tabs-header">
        <button class="tab-btn" data-tab="description">Description</button>
        <button class="tab-btn active" data-tab="specs">Specifications</button>
        <button class="tab-btn" data-tab="reviews">Reviews</button>
      </div>
      <div id="description" class="tab-panel">
        <div class="description-content">
          <p id="tab-description-text">Loading description...</p>
        </div>
      </div>
      <div id="specs" class="tab-panel active">
        <div class="specs-table">
          <div class="spec-row">
            <span class="spec-label">Brand</span>
            <span class="spec-value" id="spec-brand">-</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Category</span>
            <span class="spec-value" id="spec-category">-</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Model</span>
            <span class="spec-value" id="spec-model">-</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Warranty</span>
            <span class="spec-value">2 Years Manufacturer Warranty</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Energy Rating</span>
            <span class="spec-value">A+++</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Dimensions</span>
            <span class="spec-value">Standard Size</span>
          </div>
        </div>
      </div>
      <div id="reviews" class="tab-panel">
        <div class="reviews-summary">
          <div class="rating-overview">
            <div class="rating-score">4.8</div>
            <div class="rating-stars">
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d"></i>
              <i data-lucide="star" fill="#ddd" color="#ddd"></i>
            </div>
            <p class="rating-count">Based on 120+ customer reviews</p>
          </div>
        </div>
        <div class="reviews-list">
          <div class="review-item">
            <div class="review-header">
              <strong>John D.</strong>
              <span class="review-date">2 weeks ago</span>
            </div>
            <div class="review-rating">
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
            </div>
            <p class="review-text">Excellent product! Works perfectly and looks great in my kitchen.</p>
          </div>
          <div class="review-item">
            <div class="review-header">
              <strong>Sarah M.</strong>
              <span class="review-date">1 month ago</span>
            </div>
            <div class="review-rating">
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#fbc02d" color="#fbc02d" size="14"></i>
              <i data-lucide="star" fill="#ddd" color="#ddd" size="14"></i>
            </div>
            <p class="review-text">Very good quality. Delivery was fast and packaging was secure.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Related Products Scroller -->
    <section class="related-section">
      <h2 class="section-title">You Might Also Like</h2>
      <div class="scroller-container" id="related-products-scroller">
        <!-- Injected via JS -->
      </div>
    </section>


  </main>

  <!-- FOOTER -->
  <footer class="main-footer">
    <div class="footer-container">
      <div class="footer-col">
        <h4>Shopping Guide</h4>
        <ul>
          <li><a href="#">How to buy</a></li>
          <li><a href="#">Payment methods</a></li>
          <li><a href="#">Shipping & Delivery</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Customer Service</h4>
        <ul>
          <li><a href="#">Help Center</a></li>
          <li><a href="#">Refund Policy</a></li>
          <li><a href="#">Contact Us</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Stay Connected</h4>
        <div class="social-icons">
          <i data-lucide="facebook"></i>
          <i data-lucide="instagram"></i>
          <i data-lucide="twitter"></i>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      &copy; 2026 Tech House. All rights reserved.
    </div>
  </footer>

  <!-- MOBILE BOTTOM NAV -->
  <div class="mobile-bar">
    <a href="../../index.html" class="mobile-nav-item">
      <i data-lucide="home"></i>
      <span>Home</span>
    </a>
    <div class="mobile-nav-item" onclick="toggleMenu()">
      <i data-lucide="layout-grid"></i>
      <span>Catalog</span>
    </div>
    <a href="wishlist_page.html" class="mobile-nav-item">
      <i data-lucide="heart"></i>
      <span>Wishlist</span>
    </a>
    <a href="./cart_page.html" class="mobile-nav-item">
      <i data-lucide="shopping-cart"></i>
      <span>Cart</span>
      <span class="cart-badge">0</span>
    </a>
    <a href="./auth_page.html" class="mobile-nav-item">
      <i data-lucide="user"></i>
      <span>Account</span>
    </a>
  </div>

  <!-- STICKY PRODUCT BAR (Desktop) -->
  <div class="sticky-product-bar" id="stickyBar">
    <div class="sticky-content">
      <div class="sticky-left">
        <div class="sticky-img"><img src="" id="sticky-img" alt=""></div>
        <div class="sticky-info">
          <h3 id="sticky-title">Product</h3>
        </div>
      </div>
      <div class="sticky-right">
        <span class="current-price" id="sticky-price" style="font-size: 1.2rem;">$0</span>
        <button class="sticky-cart-btn">Add to Cart</button>
        <!-- Smart wrapper handled by JS: sticky-smart-wrapper -->
      </div>
    </div>
  </div>

  <script src="../scripts/auth.js"></script>
  <script src="../data/products.js"></script>
  <script src="../scripts/cartManager.js"></script>
  <script src="../scripts/wishlistManager.js"></script>
  <script src="../scripts/toast.js"></script>
  <script src="../scripts/product_details.js"></script>
  <script>
    // Inline Toggle Menu for Sidebar
    function toggleMenu() {
      const sidebar = document.getElementById('mobileSidebar');
      const overlay = document.getElementById('overlay');
      if (sidebar && overlay) {
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
        document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : 'auto';
      }
    }

    // Search Functionality
    let searchTimeout;

    function highlightText(text, query) {
      if (!query) return text;
      const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      return text.replace(regex, '<span class="highlight">$1</span>');
    }

    function searchProducts(query) {
      if (!query || query.length < 2) return [];

      const searchTerms = query.toLowerCase().split(' ').filter(t => t.length > 0);

      return window.products.filter(product => {
        const searchableText = `
          ${product.name} 
          ${product.category} 
          ${product.brand} 
          ${product.description || ''}
        `.toLowerCase();

        return searchTerms.some(term => searchableText.includes(term));
      }).sort((a, b) => {
        // Sort by relevance - products matching name first
        const aNameMatch = a.name.toLowerCase().includes(query.toLowerCase());
        const bNameMatch = b.name.toLowerCase().includes(query.toLowerCase());
        if (aNameMatch && !bNameMatch) return -1;
        if (!aNameMatch && bNameMatch) return 1;
        return 0;
      });
    }

    function showSearchResults(results, query) {
      const dropdown = document.querySelector('.search-results-dropdown');
      if (!dropdown) return;

      if (results.length === 0) {
        dropdown.innerHTML = `
          <div class="search-no-results">
            <i data-lucide="search-x"></i>
            <p>No products found for "${query}"</p>
            <p style="font-size: 12px; color: #999;">Try different keywords</p>
          </div>
        `;
        dropdown.style.display = 'block';
        if (window.lucide) lucide.createIcons();
        return;
      }

      const maxResults = 5;
      const displayResults = results.slice(0, maxResults);
      const hasMore = results.length > maxResults;

      let html = '<div class="search-results">';

      displayResults.forEach(product => {
        const price = `${product.price.toLocaleString('en-US')} UZS`;
        const image = Array.isArray(product.images) ? product.images[0] : (product.image ? product.image[0] : '/src/assets/images/placeholder.jpg');
        const highlightedName = highlightText(product.name, query);

        html += `
          <a href="appliance_details_page.html?id=${product.id}" class="search-result-item">
            <img src="${image}" alt="${product.name}" class="search-result-image" onerror="this.src='/src/assets/images/placeholder.jpg'">
            <div class="search-result-details">
              <div class="search-result-name">${highlightedName}</div>
              <div class="search-result-meta">
                <span class="search-result-category">${product.category}</span>
              </div>
              <div class="search-result-price">${price}</div>
            </div>
          </a>
        `;
      });

      if (hasMore) {
        html += `
          <a href="appliances_page.html?search=${encodeURIComponent(query)}" class="search-see-more">
            See all ${results.length} results â†’
          </a>
        `;
      }

      html += '</div>';
      dropdown.innerHTML = html;
      dropdown.style.display = 'block';
      if (window.lucide) lucide.createIcons();
    }

    function handleSearchSubmit(e) {
      e.preventDefault();
      const input = document.getElementById('searchInput');
      const query = input ? input.value.trim() : '';
      if (query) {
        window.location.href = `appliances_page.html?search=${encodeURIComponent(query)}`;
      } else {
        window.location.href = 'appliances_page.html';
      }
    }

    // Catalog button handler
    document.addEventListener('DOMContentLoaded', () => {
      const catalogBtn = document.querySelector('.btn-catalog');
      if (catalogBtn) {
        catalogBtn.onclick = () => window.location.href = 'appliances_page.html';
      }

      // Header scroll animation
      const header = document.getElementById('mainHeader');
      if (header) {
        window.addEventListener('scroll', () => {
          if (window.scrollY > 50) {
            header.classList.add('scrolled');
          } else {
            header.classList.remove('scrolled');
          }
        });
      }

      // Initialize icons
      if (window.lucide) lucide.createIcons();

      // Search functionality event listeners
      const searchInput = document.getElementById('searchInput');
      const searchForm = document.getElementById('searchForm');
      const dropdown = document.querySelector('.search-results-dropdown');

      if (searchInput && searchForm) {
        // Real-time search as user types
        searchInput.addEventListener('input', (e) => {
          const query = e.target.value.trim();

          // Debounce search
          clearTimeout(searchTimeout);

          if (query.length < 2) {
            if (dropdown) dropdown.style.display = 'none';
            return;
          }

          searchTimeout = setTimeout(() => {
            const results = searchProducts(query);
            showSearchResults(results, query);
          }, 300);
        });

        // Handle form submission
        searchForm.addEventListener('submit', handleSearchSubmit);
      }

      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        const searchArea = document.querySelector('.search-area');
        if (dropdown && searchArea && !searchArea.contains(e.target)) {
          dropdown.style.display = 'none';
        }
      });



      // Close menu when clicking a category link (Mobile)
      document.querySelectorAll('.cat-list a').forEach(link => {
        link.addEventListener('click', toggleMenu);
      });
    });
  </script>
</body>

</html>